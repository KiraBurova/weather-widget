(this["webpackJsonpweather-app"]=this["webpackJsonpweather-app"]||[]).push([[0],{10:function(e,t,n){e.exports={widget:"Widget_widget__16nWC",widgetTop:"Widget_widgetTop__1QKOY",settingsIcon:"Widget_settingsIcon__1qNME",place:"Widget_place__3i_Xq",temperature:"Widget_temperature__2z1dA",weatherDescription:"Widget_weatherDescription__2_KiV",wind:"Widget_wind__1ziyN",pressure:"Widget_pressure__2Ke1F",row:"Widget_row__1zs8w",boldText:"Widget_boldText__2FTSb"}},11:function(e,t,n){e.exports={settings:"Settings_settings__TQlU_",settingsTop:"Settings_settingsTop__15DuA",closeIcon:"Settings_closeIcon__1ybnQ",addedLocations:"Settings_addedLocations__2jW7U",emptyPlaceholder:"Settings_emptyPlaceholder__2iRUq"}},13:function(e,t,n){e.exports={formLabel:"AddLocation_formLabel__-uEro",form:"AddLocation_form__1tXxt",addButton:"AddLocation_addButton__201-N",locationInput:"AddLocation_locationInput__2ebaA"}},14:function(e,t,n){e.exports={container:"App_container__eSJ6i",app:"App_app__2ziFi",settingsIcon:"App_settingsIcon__1cVps",error:"App_error__1LS0k"}},16:function(e,t,n){e.exports={item:"LocationItem_item__2M2rr",dragIcon:"LocationItem_dragIcon__AscEE",deleteIcon:"LocationItem_deleteIcon__1vC8d"}},43:function(e,t,n){},68:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),o=n(7),i=n.n(o),r=(n(43),n(9)),c=n(5),d=n(4),l=n(30),u=n.n(l),h=n(37),p=n(69),j=n(20),b=n.n(j),m=function(e){return"https://openweathermap.org/img/wn/".concat(e,"@2x.png")},g=function(e){return b.a.get("https://api.openweathermap.org/data/2.5/weather?q=".concat(e,"&appid=").concat("3c4aa69b71fd74a7a45c94ca31623a52","&units=metric"))},f=function(e){return Math.round(e)},_=function(e){return{name:e.name,countryName:e.sys.country,weather:e.weather,feelsLike:e.main.feels_like,temperature:e.main.temp,wind:e.wind,humidity:e.main.humidity,visibility:e.visibility,pressure:e.main.pressure,clouds:e.clouds.all}};function O(){return{loading:!1,serverError:"",locations:[],weatherReports:[],setLoading:function(e){this.loading=e},setServerError:function(e){this.serverError=e},fetchWeatherReportByLocation:function(e,t){var n=this;this.setLoading(!0),function(e,t){return b.a.get("https://api.openweathermap.org/data/2.5/weather?lat=".concat(e,"&lon=").concat(t,"&appid=").concat("3c4aa69b71fd74a7a45c94ca31623a52","&units=metric"))}(e,t).then((function(e){var t=_(e.data);n.setWeatherReports(t);var a={name:t.name,id:Object(p.a)()};n.addLocation(a),n.setLocationsToLocalStorage()})).catch((function(e){return n.setServerError(e.message)})).then((function(){return n.setLoading(!1)}))},fetchWeatherReportByCityName:function(e){var t=this;this.setLoading(!0),g(e.name).then((function(n){t.addLocation(e),t.setLocationsToLocalStorage();var a=_(n.data);t.setWeatherReports(a),console.log(a)})).catch((function(e){return t.setServerError(e.message)})).then((function(){return t.setLoading(!1)}))},fetchAllWeatherReportsByCityName:function(e){var t=this;this.setLoading(!0),Promise.all(e).then((function(e){e.forEach((function(e){var n={name:e.data.name,id:Object(p.a)()};t.addLocation(n),t.setLocationsToLocalStorage();var a=_(e.data);t.setWeatherReports(a)}))})).catch((function(e){return t.setServerError(e.message)})).then((function(){return t.setLoading(!1)}))},reorderWeatherReports:function(){var e=this;this.weatherReports=Object(h.a)(this.weatherReports).sort((function(t,n){return e.locations.findIndex((function(e){return e.name.toLowerCase()===t.name.toLowerCase()}))-e.locations.findIndex((function(e){return e.name.toLowerCase()===n.name.toLowerCase()}))}))},setWeatherReports:function(e){this.weatherReports.push(e)},addLocation:function(e){this.locations.push(e)},setLocations:function(e){this.locations=e},deleteLocation:function(e){this.locations=this.locations.filter((function(t){return t.name!==e})),this.weatherReports=this.weatherReports.filter((function(t){return t.name!==e})),this.setLocationsToLocalStorage()},reorderLocations:function(e,t,n){var a=Array.from(e),s=a.splice(t,1),o=Object(r.a)(s,1)[0];a.splice(n,0,o),this.setLocations(a),this.setLocationsToLocalStorage(),this.reorderWeatherReports()},setLocationsToLocalStorage:function(){var e=JSON.stringify(this.locations);localStorage.setItem("locations",e)},getLocationFromLocalStorage:function(){var e=localStorage.getItem("locations")||"{}";return JSON.parse(e)}}}var x=n(1),v=s.a.createContext(null),w=function(e){var t=e.children,n=Object(c.b)(O);return Object(x.jsx)(v.Provider,{value:n,children:t})},L=function(){var e=s.a.useContext(v);if(!e)throw new Error("useStore must be used within a StoreProvider.");return e},N=n(31),S=n.n(N),y=n(32),I=n.n(y),R=n(8),W=n.n(R),T=function(e){var t,n=e.weatherReport;return Object(x.jsxs)("div",{children:[Object(x.jsxs)("div",{className:W.a.row,children:[n.wind.speed&&Object(x.jsxs)("span",{className:W.a.wind,"data-testid":"wind",children:[Object(x.jsx)(d.Icon,{icon:I.a}),n.wind.speed,"m/s"]}),n.pressure&&Object(x.jsxs)("span",{"data-testid":"pressure",className:W.a.pressure,children:[Object(x.jsx)(d.Icon,{icon:S.a}),n.pressure,"hPa"]})]}),Object(x.jsxs)("div",{className:W.a.row,children:[n.humidity&&Object(x.jsxs)("span",{"data-testid":"humidity",children:["Humidity: ",Object(x.jsxs)("span",{className:W.a.boldText,children:[n.humidity,"%"]})]}),n.clouds&&Object(x.jsxs)("span",{"data-testid":"cloudiness",children:["Cloudiness: ",Object(x.jsxs)("span",{className:W.a.boldText,children:[n.clouds,"%"]})]})]}),n.visibility&&Object(x.jsxs)("span",{"data-testid":"visibility",children:["Visibility: ",Object(x.jsxs)("span",{className:W.a.boldText,children:[(t=n.visibility,t/1e3),"km"]})]})]})},C=n(10),E=n.n(C),A=function(e){var t=e.weatherReport;return Object(x.jsxs)("div",{className:E.a.widget,children:[Object(x.jsx)("div",{className:E.a.widgetTop,children:t.name&&Object(x.jsxs)("span",{className:E.a.place,"data-testid":"place",children:[t.name,", ",t.countryName]})}),Object(x.jsxs)("div",{className:E.a.temperature,"data-testid":"temperature",children:[t.weather.map((function(e){return Object(x.jsx)("img",{src:m(e.icon),alt:"Weather icon"},e.id)})),Object(x.jsxs)("span",{children:[f(t.temperature),"\xb0C"]})]}),Object(x.jsxs)("p",{className:E.a.weatherDescriptionContainer,"data-testid":"description",children:[Object(x.jsxs)("span",{children:["Feels like ",f(t.feelsLike),"\xb0C."]}),Object(x.jsxs)("span",{className:E.a.weatherDescription,children:[t.weather.map((function(e){return e.description})),"."]})]}),Object(x.jsx)(T,{weatherReport:t})]})},P=n(6),k=n(17),B=n(33),F=n.n(B),D=n(34),J=n.n(D),M=n(35),q=n.n(M),z=n(16),H=n.n(z),U=Object(c.a)((function(e){var t,n=e.location,a=e.dragHandleProps,s=L().deleteLocation;return Object(x.jsxs)("div",{className:H.a.item,children:[Object(x.jsx)("div",Object(P.a)(Object(P.a)({},a),{},{children:Object(x.jsx)(d.Icon,{icon:J.a,className:H.a.dragIcon})})),n.name,Object(x.jsx)("span",{className:H.a.deleteIcon,onClick:(t=n.name,function(){s(t)}),role:"button",children:Object(x.jsx)(d.Icon,{icon:q.a})})]})})),K=n(36),Q=n.n(K),V=n(13),G=n.n(V),X=Object(c.a)((function(){var e=L().fetchWeatherReportByCityName,t=Object(a.useState)(""),n=Object(r.a)(t,2),s=n[0],o=n[1];return Object(x.jsxs)("div",{children:[Object(x.jsx)("span",{className:G.a.formLabel,children:"Add location:"}),Object(x.jsxs)("form",{className:G.a.form,onSubmit:function(t){t.preventDefault();var n={name:s,id:Object(p.a)()};e(n),o("")},"data-testid":"form",children:[Object(x.jsx)("input",{autoFocus:!0,className:G.a.locationInput,value:s,onChange:function(e){var t=e.target.value;o(t)}}),Object(x.jsx)("button",{type:"submit",className:G.a.addButton,disabled:!s,children:Object(x.jsx)(d.Icon,{icon:Q.a})})]})]})})),Y=n(11),Z=n.n(Y),$=Object(c.a)((function(e){var t=e.handleToggleSettings,n=L(),a=n.locations,s=n.reorderLocations;return Object(x.jsxs)("div",{className:Z.a.settings,children:[Object(x.jsxs)("div",{className:Z.a.settingsTop,children:[Object(x.jsx)("span",{children:"Settings"}),Object(x.jsx)("div",{onClick:t,children:Object(x.jsx)(d.Icon,{icon:F.a,className:Z.a.closeIcon})})]}),Object(x.jsx)(k.a,{onDragEnd:function(e){e.destination&&s(a,e.source.index,e.destination.index)},children:Object(x.jsx)(k.c,{droppableId:"droppable",children:function(e){return Object(x.jsxs)("div",Object(P.a)(Object(P.a)({className:Z.a.addedLocations},e.droppableProps),{},{ref:e.innerRef,children:[a.map((function(e,t){return Object(x.jsx)(k.b,{draggableId:e.name,index:t,children:function(t){return Object(x.jsx)("div",Object(P.a)(Object(P.a)({ref:t.innerRef},t.draggableProps),{},{style:Object(P.a)(Object(P.a)({},t.draggableProps.style),{},{marginBottom:"5px"}),children:Object(x.jsx)(U,{dragHandleProps:t.dragHandleProps,location:e})}))}},e.id)})),e.placeholder]}))}})}),!a.length&&Object(x.jsx)("div",{className:Z.a.emptyPlaceholder,children:"No settings yet."}),Object(x.jsx)(X,{})]})})),ee=n(14),te=n.n(ee),ne=Object(c.a)((function(){var e=L(),t=e.loading,n=e.serverError,s=e.weatherReports,o=e.getLocationFromLocalStorage,i=e.fetchWeatherReportByLocation,c=e.fetchAllWeatherReportsByCityName,l=Object(a.useState)(""),h=Object(r.a)(l,2),p=h[0],j=h[1],b=Object(a.useState)(!1),m=Object(r.a)(b,2),f=m[0],_=m[1],O=Object(a.useCallback)((function(){_(!f)}),[f]);return Object(a.useEffect)((function(){"geolocation"in navigator?navigator.geolocation.getCurrentPosition((function(e){var t=e.coords,n=t.latitude,a=t.longitude,s=o(),r=[];Object.values(s).length?(Object.values(s).forEach((function(e){r.push(g(e.name))})),c(r)):i(n,a)}),(function(e){return j(e.message)})):j("Geolocation is not available")}),[i,c,o]),Object(x.jsx)("div",{className:te.a.app,children:Object(x.jsxs)("div",{className:te.a.container,children:[f?Object(x.jsx)($,{handleToggleSettings:O}):Object(x.jsx)(x.Fragment,{children:!!s.length&&Object(x.jsxs)("div",{children:[Object(x.jsx)("div",{children:s.map((function(e){return Object(x.jsx)(A,{weatherReport:e,handleToggleSettings:O},e.name)}))}),Object(x.jsx)("div",{onClick:O,role:"button",children:Object(x.jsx)(d.Icon,{icon:u.a,className:te.a.settingsIcon})})]})}),(p||n)&&Object(x.jsx)("span",{className:te.a.error,"data-testid":"error",children:p||n}),t&&Object(x.jsx)("span",{children:"Loading..."})]})})}));i.a.render(Object(x.jsx)(s.a.StrictMode,{children:Object(x.jsx)(w,{children:Object(x.jsx)(ne,{})})}),document.getElementById("root"))},8:function(e,t,n){e.exports={wind:"Stats_wind__1S3td",pressure:"Stats_pressure__3uGLM",row:"Stats_row__nyU4p",boldText:"Stats_boldText__1x1uB"}}},[[68,1,2]]]);
//# sourceMappingURL=main.a4f857db.chunk.js.map